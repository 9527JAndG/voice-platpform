{
  "version": "2.0",
  "name": "小爱同学测试用例集",
  "description": "小米小爱同学智能家居控制 API 测试用例",
  "updated": "2026-02-25",
  "base_url": "http://localhost:8080",
  "test_user": {
    "username": "user1",
    "password": "password"
  },
  "test_cases": [
    {
      "id": "miai-001",
      "name": "设备发现",
      "description": "测试小爱同学设备发现功能",
      "method": "POST",
      "endpoint": "/miai/discovery",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {},
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success",
        "data_contains": ["devices", "count"]
      }
    },
    {
      "id": "miai-002",
      "name": "设备开机",
      "description": "测试小爱同学设备开机功能",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "turn-on",
        "deviceId": "vacuum-001",
        "requestId": "req-turnon-001"
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-003",
      "name": "设备关机",
      "description": "测试小爱同学设备关机功能",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "turn-off",
        "deviceId": "vacuum-001",
        "requestId": "req-turnoff-001"
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-004",
      "name": "设备暂停",
      "description": "测试小爱同学设备暂停功能",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "pause",
        "deviceId": "vacuum-001",
        "requestId": "req-pause-001"
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-005",
      "name": "设备继续",
      "description": "测试小爱同学设备继续功能",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "continue",
        "deviceId": "vacuum-001",
        "requestId": "req-continue-001"
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-006",
      "name": "设置模式 - 自动模式",
      "description": "测试小爱同学设置设备为自动模式",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "set-mode",
        "deviceId": "vacuum-001",
        "requestId": "req-setmode-auto-001",
        "params": {
          "mode": "auto"
        }
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-007",
      "name": "设置模式 - 定点模式",
      "description": "测试小爱同学设置设备为定点模式",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "set-mode",
        "deviceId": "vacuum-001",
        "requestId": "req-setmode-spot-001",
        "params": {
          "mode": "spot"
        }
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-008",
      "name": "设置模式 - 沿边模式",
      "description": "测试小爱同学设置设备为沿边模式",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "set-mode",
        "deviceId": "vacuum-001",
        "requestId": "req-setmode-edge-001",
        "params": {
          "mode": "edge"
        }
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success"
      }
    },
    {
      "id": "miai-009",
      "name": "设备状态查询",
      "description": "测试小爱同学设备状态查询功能",
      "method": "POST",
      "endpoint": "/miai/query",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "deviceId": "vacuum-001",
        "requestId": "req-query-001"
      },
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success",
        "data_contains": ["status"]
      }
    },
    {
      "id": "miai-010",
      "name": "健康检查",
      "description": "测试小爱同学健康检查接口",
      "method": "GET",
      "endpoint": "/miai/health",
      "headers": {},
      "body": null,
      "expected": {
        "status": 200,
        "code": 0,
        "message": "success",
        "data_contains": ["status", "platform", "timestamp"]
      }
    },
    {
      "id": "miai-011",
      "name": "错误处理 - 无效Token",
      "description": "测试无效Token的错误处理",
      "method": "POST",
      "endpoint": "/miai/discovery",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer invalid_token_12345"
      },
      "body": {},
      "expected": {
        "status": 401,
        "code": 401,
        "message": "访问令牌无效或已过期"
      }
    },
    {
      "id": "miai-012",
      "name": "错误处理 - 设备不存在",
      "description": "测试设备不存在的错误处理",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "turn-on",
        "deviceId": "non-existent-device",
        "requestId": "req-error-device-001"
      },
      "expected": {
        "status": 200,
        "code": 404,
        "message": "设备不存在"
      }
    },
    {
      "id": "miai-013",
      "name": "错误处理 - 无效模式",
      "description": "测试无效模式的错误处理",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "intent": "set-mode",
        "deviceId": "vacuum-001",
        "requestId": "req-error-mode-001",
        "params": {
          "mode": "invalid_mode"
        }
      },
      "expected": {
        "status": 200,
        "code": 400,
        "message_contains": "不支持的模式"
      }
    },
    {
      "id": "miai-014",
      "name": "错误处理 - 缺少Intent参数",
      "description": "测试缺少Intent参数的错误处理",
      "method": "POST",
      "endpoint": "/miai/control",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer {{access_token}}"
      },
      "body": {
        "deviceId": "vacuum-001",
        "requestId": "req-error-intent-001"
      },
      "expected": {
        "status": 200,
        "code": 400,
        "message": "缺少 intent 参数"
      }
    }
  ],
  "notes": [
    "测试前需要先获取 access_token",
    "使用 OAuth2 授权流程获取 token",
    "测试账号: user1/password",
    "测试设备: vacuum-001 (客厅扫地机器人)",
    "支持的模式: auto, spot, edge",
    "小爱同学使用扁平化的 JSON 结构，接口最简洁",
    "小爱的操作名称使用小写+连字符格式（如 turn-on）"
  ]
}
