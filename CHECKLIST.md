# 项目检查清单

## 📋 部署前检查

### 环境检查
- [ ] JDK 1.8+ 已安装
- [ ] MySQL 8.0+ 已安装并启动
- [ ] Maven 3.6+ 已安装
- [ ] 端口 8080 未被占用

### 数据库检查
- [ ] 已创建 smarthomedb 数据库
- [ ] 已执行 smarthomedb.sql 脚本
- [ ] 数据库连接信息正确
- [ ] 测试数据已插入

### 配置检查
- [ ] application.yml 中数据库密码已修改
- [ ] OAuth 配置参数已确认
- [ ] 日志级别已设置

## 🧪 功能测试清单

### OAuth 授权测试
- [ ] 访问授权页面正常显示
- [ ] 点击"授权"按钮正常跳转
- [ ] 获取授权码成功
- [ ] 用授权码换取 Token 成功
- [ ] Token 包含 access_token 和 refresh_token
- [ ] 刷新 Token 功能正常

### 设备发现测试
- [ ] 携带 Token 请求设备发现接口
- [ ] 返回设备列表
- [ ] 设备信息完整（ID、名称、类型等）
- [ ] 设备属性正确（电源状态、模式、电量）

### 设备控制测试
- [ ] 开机命令执行成功
- [ ] 关机命令执行成功
- [ ] 暂停命令执行成功
- [ ] 继续命令执行成功
- [ ] 设置模式命令执行成功
- [ ] 数据库中设备状态已更新

### 设备查询测试
- [ ] 查询设备状态成功
- [ ] 返回的状态信息正确
- [ ] 电量信息正确

### 错误处理测试
- [ ] 无效 Token 返回 401 错误
- [ ] 过期 Token 返回错误
- [ ] 设备不存在返回错误
- [ ] 错误信息格式正确

## 🔐 安全检查

### OAuth 安全
- [ ] 授权码有效期设置合理（2分钟）
- [ ] Access Token 有效期设置合理（3天）
- [ ] Refresh Token 有效期设置合理（30天）
- [ ] 客户端认证正常工作
- [ ] redirect_uri 验证正常

### API 安全
- [ ] 所有智能家居接口都需要 Token
- [ ] Token 验证逻辑正确
- [ ] 错误信息不泄露敏感数据

### 数据安全
- [ ] 数据库密码不在代码中硬编码
- [ ] 敏感信息已加密存储
- [ ] SQL 注入防护正常

## 📱 天猫精灵平台配置检查

### 技能配置
- [ ] 已创建"智能家居"技能
- [ ] 技能名称和描述已填写
- [ ] 技能图标已上传

### OAuth 配置
- [ ] 授权地址配置正确
- [ ] Token 地址配置正确
- [ ] Client ID 配置正确
- [ ] Client Secret 配置正确
- [ ] 回调地址配置正确

### Webhook 配置
- [ ] 设备发现接口地址正确
- [ ] 设备控制接口地址正确
- [ ] 设备查询接口地址正确
- [ ] 所有地址使用 HTTPS（生产环境）

### 测试配置
- [ ] 技能已提交测试
- [ ] 在天猫精灵 App 中可以找到技能
- [ ] 授权流程正常
- [ ] 设备发现正常
- [ ] 语音控制正常

## 🌐 网络配置检查

### 本地开发
- [ ] 使用 ngrok 或其他内网穿透工具
- [ ] 获取到公网 HTTPS 地址
- [ ] 天猫精灵平台可以访问

### 生产环境
- [ ] 应用已部署到云服务器
- [ ] 域名已配置
- [ ] SSL 证书已配置
- [ ] 防火墙已开放端口
- [ ] Nginx 反向代理已配置

## 📊 性能检查

### 响应时间
- [ ] OAuth 授权响应 < 1秒
- [ ] Token 获取响应 < 500ms
- [ ] 设备发现响应 < 1秒
- [ ] 设备控制响应 < 500ms

### 并发测试
- [ ] 支持多用户同时授权
- [ ] 支持多设备同时控制
- [ ] 数据库连接池正常工作

### 资源使用
- [ ] 内存使用正常
- [ ] CPU 使用正常
- [ ] 数据库连接数正常

## 📝 文档检查

### 代码文档
- [ ] 关键类有注释
- [ ] 关键方法有注释
- [ ] 复杂逻辑有说明

### 项目文档
- [ ] README.md 完整
- [ ] QUICKSTART.md 可用
- [ ] API.md 准确
- [ ] DEPLOYMENT.md 详细

## 🔄 日志检查

### 日志配置
- [ ] 日志级别设置正确
- [ ] 日志格式清晰
- [ ] 日志文件路径正确

### 日志内容
- [ ] OAuth 授权有日志
- [ ] Token 生成有日志
- [ ] 设备控制有日志
- [ ] 错误有详细日志

## 🎯 语音控制测试

### 基本控制
- [ ] "天猫精灵，打开客厅扫地机器人" ✓
- [ ] "天猫精灵，关闭扫地机器人" ✓
- [ ] "天猫精灵，暂停扫地机器人" ✓
- [ ] "天猫精灵，继续扫地" ✓

### 模式控制
- [ ] "天猫精灵，扫地机器人切换到自动模式" ✓
- [ ] "天猫精灵，扫地机器人切换到定点模式" ✓
- [ ] "天猫精灵，扫地机器人切换到沿边模式" ✓

### 状态查询
- [ ] "天猫精灵，扫地机器人电量还有多少" ✓
- [ ] "天猫精灵，扫地机器人是什么状态" ✓

## 🐛 常见问题检查

### 启动问题
- [ ] 数据库连接失败 → 检查配置
- [ ] 端口被占用 → 修改端口
- [ ] 依赖下载失败 → 检查网络

### 授权问题
- [ ] 授权页面无法访问 → 检查服务是否启动
- [ ] 授权后无法跳转 → 检查 redirect_uri
- [ ] Token 获取失败 → 检查客户端认证

### 控制问题
- [ ] 设备控制无响应 → 检查 Token
- [ ] 设备不存在 → 检查设备 ID
- [ ] 权限不足 → 检查 Token 验证

## ✅ 上线前最终检查

### 代码检查
- [ ] 代码已提交到版本控制
- [ ] 没有调试代码
- [ ] 没有硬编码的密码
- [ ] 没有 TODO 标记

### 配置检查
- [ ] 生产环境配置正确
- [ ] 数据库配置正确
- [ ] 日志配置正确
- [ ] 安全配置正确

### 备份检查
- [ ] 数据库已备份
- [ ] 配置文件已备份
- [ ] 代码已备份

### 监控检查
- [ ] 日志监控已配置
- [ ] 性能监控已配置
- [ ] 告警规则已配置

## 📞 问题排查

如果遇到问题，按以下顺序检查：

1. **查看日志**
   - 应用日志
   - 数据库日志
   - Nginx 日志

2. **检查配置**
   - application.yml
   - 数据库连接
   - 天猫精灵平台配置

3. **测试接口**
   - 使用 Postman 测试
   - 查看请求响应
   - 检查错误信息

4. **查看文档**
   - QUICKSTART.md
   - DEPLOYMENT.md
   - API.md

---

**检查完成后，在每项前打 ✓ 表示已通过检查**
