{
  "info": {
    "name": "Alexa Smart Home API",
    "description": "Alexa 智能音箱扫地机器人对接测试集合",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. OAuth 授权流程",
      "item": [
        {
          "name": "1.1 获取授权码（浏览器访问）",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/authorize?client_id=alexa_client_id&redirect_uri=https://pitangui.amazon.com/api/skill/link/YOUR_VENDOR_ID&response_type=code&state=random_state",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["authorize"],
              "query": [
                {
                  "key": "client_id",
                  "value": "alexa_client_id",
                  "description": "Alexa 客户端 ID"
                },
                {
                  "key": "redirect_uri",
                  "value": "https://pitangui.amazon.com/api/skill/link/YOUR_VENDOR_ID",
                  "description": "Alexa 回调地址"
                },
                {
                  "key": "response_type",
                  "value": "code",
                  "description": "固定值 code"
                },
                {
                  "key": "state",
                  "value": "random_state",
                  "description": "随机状态值"
                }
              ]
            },
            "description": "在浏览器中访问此 URL，使用 testuser/password123 登录并授权"
          },
          "response": []
        },
        {
          "name": "1.2 用授权码换取 Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "authorization_code",
                  "type": "text"
                },
                {
                  "key": "code",
                  "value": "{{authorization_code}}",
                  "description": "从步骤 1.1 获取的授权码",
                  "type": "text"
                },
                {
                  "key": "client_id",
                  "value": "alexa_client_id",
                  "type": "text"
                },
                {
                  "key": "client_secret",
                  "value": "alexa_client_secret",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "http://localhost:8080/token",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["token"]
            },
            "description": "使用授权码换取访问令牌"
          },
          "response": []
        },
        {
          "name": "1.3 刷新 Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "refresh_token",
                  "type": "text"
                },
                {
                  "key": "refresh_token",
                  "value": "{{refresh_token}}",
                  "description": "从步骤 1.2 获取的刷新令牌",
                  "type": "text"
                },
                {
                  "key": "client_id",
                  "value": "alexa_client_id",
                  "type": "text"
                },
                {
                  "key": "client_secret",
                  "value": "alexa_client_secret",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "http://localhost:8080/token",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["token"]
            },
            "description": "使用刷新令牌获取新的访问令牌"
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. 设备发现",
      "item": [
        {
          "name": "2.1 发现设备",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.Discovery\",\n      \"name\": \"Discover\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\"\n    },\n    \"payload\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      }\n    }\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "发现用户的所有扫地机器人设备"
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. 电源控制",
      "item": [
        {
          "name": "3.1 开机",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.PowerController\",\n      \"name\": \"TurnOn\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_001\",\n      \"cookie\": {}\n    },\n    \"payload\": {}\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "开启扫地机器人"
          },
          "response": []
        },
        {
          "name": "3.2 关机",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.PowerController\",\n      \"name\": \"TurnOff\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_001\",\n      \"cookie\": {}\n    },\n    \"payload\": {}\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "关闭扫地机器人"
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. 模式控制",
      "item": [
        {
          "name": "4.1 设置自动模式",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.ModeController\",\n      \"name\": \"SetMode\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_001\",\n      \"cookie\": {}\n    },\n    \"payload\": {\n      \"mode\": \"Auto\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "设置为自动清扫模式"
          },
          "response": []
        },
        {
          "name": "4.2 设置定点模式",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.ModeController\",\n      \"name\": \"SetMode\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_001\",\n      \"cookie\": {}\n    },\n    \"payload\": {\n      \"mode\": \"Spot\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "设置为定点清扫模式"
          },
          "response": []
        },
        {
          "name": "4.3 设置沿边模式",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.ModeController\",\n      \"name\": \"SetMode\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_001\",\n      \"cookie\": {}\n    },\n    \"payload\": {\n      \"mode\": \"Edge\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "设置为沿边清扫模式"
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. 错误测试",
      "item": [
        {
          "name": "5.1 无效 Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.PowerController\",\n      \"name\": \"TurnOn\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"invalid_token_12345\"\n      },\n      \"endpointId\": \"robot_001\",\n      \"cookie\": {}\n    },\n    \"payload\": {}\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "测试无效 Token 的错误处理"
          },
          "response": []
        },
        {
          "name": "5.2 设备不存在",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.PowerController\",\n      \"name\": \"TurnOn\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_999\",\n      \"cookie\": {}\n    },\n    \"payload\": {}\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "测试设备不存在的错误处理"
          },
          "response": []
        },
        {
          "name": "5.3 设备离线",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"directive\": {\n    \"header\": {\n      \"namespace\": \"Alexa.PowerController\",\n      \"name\": \"TurnOn\",\n      \"payloadVersion\": \"3\",\n      \"messageId\": \"{{$guid}}\",\n      \"correlationToken\": \"{{$guid}}\"\n    },\n    \"endpoint\": {\n      \"scope\": {\n        \"type\": \"BearerToken\",\n        \"token\": \"{{access_token}}\"\n      },\n      \"endpointId\": \"robot_004\",\n      \"cookie\": {}\n    },\n    \"payload\": {}\n  }\n}"
            },
            "url": {
              "raw": "http://localhost:8080/alexa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["alexa"]
            },
            "description": "测试设备离线的错误处理"
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "access_token",
      "value": "your_access_token_here",
      "type": "string"
    },
    {
      "key": "refresh_token",
      "value": "your_refresh_token_here",
      "type": "string"
    },
    {
      "key": "authorization_code",
      "value": "your_authorization_code_here",
      "type": "string"
    }
  ]
}
